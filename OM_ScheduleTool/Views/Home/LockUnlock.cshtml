@model LockUnlockViewModel

<script src="~/js/plugins/moment/moment-with-locales.min.js"></script>

@Html.Partial("_NavigationMenu", Model.LoggedOnUser)

<script language="javascript" type="text/javascript">
    $(document).ready(function () {
    });

    function UnlockMediaPlan(_mediaPlanId) {
        var ConfirmQuestionText = 'Are you sure you want to proceed?'
        $.ajax({
            url: "/MediaPlan/GetMediaPlanForUnlock/",
            data: { MediaPlanId: _mediaPlanId },
            cache: false,
            type: "GET",
            success: function (result) {
                if (result.success === true) {
                    ConfirmQuestionText = result.responseData.lockedByUserName + ' was last active on ' + moment(result.responseData.modifiedDate).format("dddd, MMMM Do, YYYY, h:mm:ss A") + ' and may still be working on ' + result.responseData.mediaPlanName + '.  Are you sure you want to proceed?';
                    swal({
                        title: 'Unlock',
                        text: ConfirmQuestionText,
                        type: 'question',
                        showCancelButton: true,
                        confirmButtonColor: '#3085d6',
                        cancelButtonColor: '#d33',
                        confirmButtonText: 'Yes',
                        preConfirm: function () {
                            return new Promise(function (resolve) {
                                setTimeout(function () {
                                    resolve();
                                }, 50);
                            });
                        }
                    }).then(
                        function (result) {
                            $.ajax({
                                url: "/MediaPlan/MediaPlanUnlockFromHomePage/",
                                data: { MediaPlanId: _mediaPlanId },
                                cache: false,
                                type: "POST",
                                success: function (result) {
                                    if (result.success !== true) {
                                        swal('Wait!', result.responseText, 'warning');
                                    }
                                    else {
                                        window.location.reload();
                                    }
                                },
                                error: function (response) {
                                    swal('Stop!', response.responseText, 'error');
                                }
                            });
                        }, function (dismiss) {
                            // dismiss can be 'cancel', 'overlay', 'esc' or 'timer'
                            // swal("Unlock", "Task was dismissed.", "warning");
                        });

                }
            },
            error: function (response) {
                swal('Stop!', response.responseText, 'error');
            }
        });


    }

    function UnlockUpfront(_upfrontId) {
        var ConfirmQuestionText = 'Are you sure you want to proceed?'
        $.ajax({
            url: "/UpfrontRemnant/GetUpfrontById/",
            data: { UpfrontId: _upfrontId },
            cache: false,
            type: "POST",
            success: function (result) {
                if (result.success === true) {
                    ConfirmQuestionText = result.data.upfrontLockedBy.displayName + ' was last active on ' + moment(result.data.upfrontLockedBy.lastActiveDt).format("dddd, MMMM Do, YYYY, h:mm:ss A") + ' and may still be working on ' + result.data.name + '.  Are you sure you want to proceed?';
                    swal({
                        title: 'Unlock',
                        text: ConfirmQuestionText,
                        type: 'question',
                        showCancelButton: true,
                        confirmButtonColor: '#3085d6',
                        cancelButtonColor: '#d33',
                        confirmButtonText: 'Yes',
                        preConfirm: function () {
                            return new Promise(function (resolve) {
                                setTimeout(function () {
                                    resolve();
                                }, 50);
                            });
                        }
                    }).then(
                        function (result) {
                            $.ajax({
                                url: "/ManageMedia/UnlockUpfront/",
                                data: { UpfrontId: _upfrontId },
                                cache: false,
                                type: "POST",
                                success: function (result) {
                                    if (result.success !== true) {
                                        swal('Wait!', result.responseText, 'warning');
                                    }
                                    else {
                                        window.location.reload();
                                    }
                                },
                                error: function (response) {
                                    swal('Stop!', response.responseText, 'error');
                                }
                            });
                        }, function (dismiss) {
                            // dismiss can be 'cancel', 'overlay', 'esc' or 'timer'
                            // swal("Unlock", "Task was dismissed.", "warning");
                        });

                }
            },
            error: function (response) {
                swal('Stop!', response.responseText, 'error');
            }
        });




    }

    function UnlockSchedule(_scheduleId) {
        var ConfirmQuestionText = 'Are you sure you want to proceed?'
        $.ajax({
            url: "/ScheduleProposal/GetScheduleById/",
            data: { ScheduleId: _scheduleId },
            cache: false,
            type: "POST",
            success: function (result) {
                if (result.success === true) {
                    ConfirmQuestionText = result.data.lockedByUser.displayName + ' was last active on ' + moment(result.data.lockedByUser.lastActiveDt).format("dddd, MMMM Do, YYYY, h:mm:ss A") + ' and may still be working on ' + result.data.scheduleName + '.  Are you sure you want to proceed?';
                    swal({
                        title: 'Unlock',
                        text: ConfirmQuestionText,
                        type: 'question',
                        showCancelButton: true,
                        confirmButtonColor: '#3085d6',
                        cancelButtonColor: '#d33',
                        confirmButtonText: 'Yes',
                        preConfirm: function () {
                            return new Promise(function (resolve) {
                                setTimeout(function () {
                                    resolve();
                                }, 50);
                            });
                        }
                    }).then(
                        function (result) {
                            $.ajax({
                                url: "/ScheduleProposal/Unlock/",
                                data: { ScheduleProposalId: _scheduleId },
                                cache: false,
                                type: "POST",
                                success: function (result) {
                                    if (result.success !== true) {
                                        swal('Wait!', result.responseText, 'warning');
                                    }
                                    else {
                                        window.location.reload();
                                    }
                                },
                                error: function (response) {
                                    swal('Stop!', response.responseText, 'error');
                                }
                            });
                        }, function (dismiss) {
                            // dismiss can be 'cancel', 'overlay', 'esc' or 'timer'
                            // swal("Unlock", "Task was dismissed.", "warning");
                        });

                }
            },
            error: function (response) {
                swal('Stop!', response.responseText, 'error');
            }
        });




    }

    function UnlockProposals(_scheduleId) {
        var ConfirmQuestionText = 'One or more users may be working in this proposal. Are you sure you want to proceed?'
      
            
                    swal({
                        title: 'Unlock',
                        text: ConfirmQuestionText,
                        type: 'question',
                        showCancelButton: true,
                        confirmButtonColor: '#3085d6',
                        cancelButtonColor: '#d33',
                        confirmButtonText: 'Yes',
                        preConfirm: function () {
                            return new Promise(function (resolve) {
                                setTimeout(function () {
                                    resolve();
                                }, 50);
                            });
                        }
                    }).then(
                        function (result) {
                            $.ajax({
                                url: "/ScheduleProposal/Unlock/",
                                data: { ScheduleProposalId: _scheduleId, IsCalledFromBtn: true }, //HM ST-724(815)
                                cache: false,
                                type: "POST",
                                success: function (result) {
                                    if (result.success !== true) {
                                        swal('Wait!', result.responseText, 'warning');
                                    }
                                    else {
                                        window.location.reload();
                                    }
                                },
                                error: function (response) {
                                    swal('Stop!', response.responseText, 'error');
                                }
                            });
                        }, function (dismiss) {
                            // dismiss can be 'cancel', 'overlay', 'esc' or 'timer'
                            // swal("Unlock", "Task was dismissed.", "warning");
                        });

    }

    function UnlockPostLog(_postlogId, _lockedBy, _lastActiveOn, _postlogName) {
        var ConfirmQuestionText = 'Are you sure you want to proceed?'
            ConfirmQuestionText = _lockedBy + ' was last active on ' + moment(_lastActiveOn).format("dddd, MMMM Do, YYYY, h:mm:ss A") + ' and may still be working on ' + _postlogName + '.  Are you sure you want to proceed?';
            swal({
                title: 'Unlock',
                text: ConfirmQuestionText,
                type: 'question',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Yes',
                preConfirm: function () {
                    return new Promise(function (resolve) {
                        setTimeout(function () {
                            resolve();
                        }, 50);
                    });
                }
            }).then(
                function (result) {
                    $.ajax({
                        url: "/Logs/UnlockPostLog/",
                        data: { PostLogId: _postlogId },
                        cache: false,
                        type: "POST",
                        success: function (result) {
                            if (result.success !== true) {
                                swal('Wait!', result.responseText, 'warning');
                            }
                            else {
                                window.location.reload();
                            }
                        },
                        error: function (response) {
                            swal('Stop!', response.responseText, 'error');
                        }
                    });
                }, function (dismiss) {
                    // dismiss can be 'cancel', 'overlay', 'esc' or 'timer'
                    // swal("Unlock", "Task was dismissed.", "warning");
                });

    }

    function UnlockPreLog(_prelogId, _lockedBy, _lastActiveOn, _prelogName) {
        var ConfirmQuestionText = 'Are you sure you want to proceed?'
        ConfirmQuestionText = _lockedBy + ' was last active on ' + moment(_lastActiveOn).format("dddd, MMMM Do, YYYY, h:mm:ss A") + ' and may still be working on ' + _prelogName + '.  Are you sure you want to proceed?';
        swal({
            title: 'Unlock',
            text: ConfirmQuestionText,
            type: 'question',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Yes',
            preConfirm: function () {
                return new Promise(function (resolve) {
                    setTimeout(function () {
                        resolve();
                    }, 50);
                });
            }
        }).then(
            function (result) {
                $.ajax({
                    url: "/Logs/UnlockPreLog/",
                    data: { preLogId: _prelogId },
                    cache: false,
                    type: "POST",
                    success: function (result) {
                        if (result) {
                           window.location.reload();
                        }
                    },
                    error: function (response) {
                        swal('Stop!', response.responseText, 'error');
                    }
                });
            }
            , function (dismiss) {                
            });

    }
</script>

<!-- Main Container -->
<main id="main-container">
    <!-- Page Content -->
    <div class="content">
        <!-- Bootstrap Forms Validation -->
        <h2 class="content-heading">Lock/Unlock Documents</h2>

        <!-- Upfronts -->
        <div class="row">
            <div class="col-md-12">
                <div class="block block-rounded">
                    <div class="block-header block-header-default">
                        <h3 class="block-title">Upfronts</h3>
                    </div>
                    <div class="block-content">
                        <!-- If you put a checkbox in thead section, it will automatically toggle all tbody section checkboxes -->
                        @if (Model.LockedUpfronts != null && Model.LockedUpfronts.Count > 0)
                        {
                            <table class="js-table-checkable table table-hover">
                                <thead>
                                    <tr>
                                        <th class="text-center">
                                        </th>
                                        <th>Name</th>
                                        <th class="d-none d-sm-table-cell" style="width: 20%;">Locked By</th>
                                        <th class="d-none d-sm-table-cell" style="width: 20%;">Locked Dt</th>
                                        <th class="d-none d-sm-table-cell" style="width: 20%;">Last Active Date</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var Upfront in Model.LockedUpfronts)
                                    {
                                        <tr>
                                            <td class="text-center">
                                                <img class="img-avatar img-avatar32" src="@Upfront.UpfrontLockedBy.ImageUrl" alt="">
                                            </td>
                                            <td>
                                                <p class="font-w600 mb-10">@Upfront.Name</p>
                                                <!--<p class="text-muted mb-0">locked by on locked date</p>-->
                                            </td>
                                            <td class="d-none d-sm-table-cell">
                                                @if (Upfront.UpfrontLockedBy.LastActiveDt > DateTime.Now.AddMinutes(-30))
                                                {
                                                    <span class="badge badge-success">@Upfront.UpfrontLockedBy.DisplayName</span>
                                                }
                                                else if (Upfront.UpfrontLockedBy.LastActiveDt > DateTime.Now.AddHours(-8))
                                                {
                                                    <span class="badge badge-warning">@Upfront.UpfrontLockedBy.DisplayName</span>
                                                }
                                                else
                                                {
                                                    <span class="badge badge-danger">@Upfront.UpfrontLockedBy.DisplayName</span>
                                                }
                                            </td>
                                            <td class="d-none d-sm-table-cell">
                                                <p class="text-muted">@Upfront.UpfrontLockedDate.ToString()</p>
                                            </td>
                                            <td class="d-none d-sm-table-cell">
                                                <p class="text-muted">@Upfront.UpfrontLockedBy.LastLoginDt.ToString()</p>
                                            </td>
                                            <td class="text-center">
                                                <div class="btn-group">
                                                    <!-- MOREWORK:  Implement loading via id for sticky gui
                                                <button type="button" onclick="javascript:window.location.href='/ManageMedia/Index?UpfrontId=@Upfront.UpfrontId.ToString()'" class="btn btn-sm btn-secondary js-tooltip-enabled" data-toggle="tooltip" title="Load Page" data-original-title="Load Page">
                                                    <i class="fa fa-link"></i>
                                                </button>
                                                -->
                                                    <button type="button" onclick='javascript:UnlockUpfront(@Upfront.UpfrontId.ToString());' class="btn btn-sm btn-secondary js-tooltip-enabled" data-toggle="tooltip" title="Unlock" data-original-title="Unlock">
                                                        <i class="fa fa-unlock"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        }
                        else
                        {
                            <p>No Upfronts Locked.</p>
                        }
                    </div>
                </div>
            </div>
        </div>

        <!-- Remnants -->
        <div class="row">
            <div class="col-md-12">
                <div class="block block-rounded">
                    <div class="block-header block-header-default">
                        <h3 class="block-title">Remnants</h3>
                    </div>
                    <div class="block-content">
                        <!-- If you put a checkbox in thead section, it will automatically toggle all tbody section checkboxes -->
                        @if (Model.LockedRemnants != null && Model.LockedRemnants.Count > 0)
                        {
                            <table class="js-table-checkable table table-hover">
                                <thead>
                                    <tr>
                                        <th class="text-center">
                                        </th>
                                        <th>Name</th>
                                        <th class="d-none d-sm-table-cell" style="width: 20%;">Locked By</th>
                                        <th class="d-none d-sm-table-cell" style="width: 20%;">Locked Dt</th>
                                        <th class="d-none d-sm-table-cell" style="width: 20%;">Last Active Date</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var remnant in Model.LockedRemnants)
                                    {
                                        <tr>
                                            <td class="text-center">
                                                <img class="img-avatar img-avatar32" src="@remnant.UpfrontLockedBy.ImageUrl" alt="">
                                            </td>
                                            <td>
                                                <p class="font-w600 mb-10">@remnant.Name</p>
                                                <!--<p class="text-muted mb-0">locked by on locked date</p>-->
                                            </td>
                                            <td class="d-none d-sm-table-cell">
                                                @if (remnant.UpfrontLockedBy.LastActiveDt > DateTime.Now.AddMinutes(-30))
                                                {
                                                    <span class="badge badge-success">@remnant.UpfrontLockedBy.DisplayName</span>
                                                }
                                                else if (remnant.UpfrontLockedBy.LastActiveDt > DateTime.Now.AddHours(-8))
                                                {
                                                    <span class="badge badge-warning">@remnant.UpfrontLockedBy.DisplayName</span>
                                                }
                                                else
                                                {
                                                    <span class="badge badge-danger">@remnant.UpfrontLockedBy.DisplayName</span>
                                                }
                                            </td>
                                            <td class="d-none d-sm-table-cell">
                                                <p class="text-muted">@remnant.UpfrontLockedDate.ToString()</p>
                                            </td>
                                            <td class="d-none d-sm-table-cell">
                                                <p class="text-muted">@remnant.UpfrontLockedBy.LastActiveDt.ToString()</p>
                                            </td>
                                            <td class="text-center">
                                                <div class="btn-group">
                                                    <!-- MOREWORK:  Implement loading via id for sticky gui
                                                <button type="button" onclick="javascript:window.location.href='/ManageMedia/Remnant?UpfrontId=@remnant.UpfrontId.ToString()'" class="btn btn-sm btn-secondary js-tooltip-enabled" data-toggle="tooltip" title="Load Page" data-original-title="Load Page">
                                                    <i class="fa fa-link"></i>
                                                </button>
                                                -->
                                                    <button type="button" onclick="javascript:UnlockUpfront(@remnant.UpfrontId.ToString());" class="btn btn-sm btn-secondary js-tooltip-enabled" data-toggle="tooltip" title="Unlock" data-original-title="Unlock">
                                                        <i class="fa fa-unlock"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        }
                        else
                        {
                            <p>No Remnants Locked.</p>
                        }
                    </div>
                </div>
            </div>
        </div>
        <!-- Media Plans -->
        <div class="row">
            <div class="col-md-12">
                <div class="block block-rounded">
                    <div class="block-header block-header-default">
                        <h3 class="block-title">Media Plans</h3>
                    </div>
                    <div class="block-content">
                        <!-- If you put a checkbox in thead section, it will automatically toggle all tbody section checkboxes -->
                        @if (Model.LockedMediaPlan != null && Model.LockedMediaPlan.Count > 0)
                        {
                            <table class="js-table-checkable table table-hover">
                                <thead>
                                    <tr>
                                        <th class="text-center">
                                        </th>
                                        <th>Name</th>
                                        <th class="d-none d-sm-table-cell" style="width: 20%;">Locked By</th>
                                        <th class="d-none d-sm-table-cell" style="width: 20%;">Locked Dt</th>
                                        <th class="d-none d-sm-table-cell" style="width: 20%;">Last Active Date</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var mediaPlan in Model.LockedMediaPlan)
                                    {
                                        <tr>
                                            <td class="text-center">
                                                <img class="img-avatar img-avatar32" src="@mediaPlan.ImageUrl" alt="">
                                            </td>
                                            <td>
                                                <p class="font-w600 mb-10">@mediaPlan.MediaPlanName</p>
                                                <!--<p class="text-muted mb-0">locked by on locked date</p>-->
                                            </td>
                                            <td class="d-none d-sm-table-cell">
                                                @if (mediaPlan.LockedDt > DateTime.Now.AddMinutes(-30))
                                                {
                                                    <span class="badge badge-success">@mediaPlan.LockedByUserName</span>
                                                }
                                                else if (mediaPlan.LockedDt > DateTime.Now.AddHours(-8))
                                                {
                                                    <span class="badge badge-warning">@mediaPlan.LockedByUserName</span>
                                                }
                                                else
                                                {
                                                    <span class="badge badge-danger">@mediaPlan.LockedByUserName</span>
                                                }
                                            </td>
                                            <td class="d-none d-sm-table-cell">
                                                <p class="text-muted">@mediaPlan.LockedDt.ToString()</p>
                                            </td>
                                            <td class="d-none d-sm-table-cell">
                                                <p class="text-muted">@mediaPlan.ModifiedDate.ToString()</p>
                                            </td>
                                            <td class="text-center">
                                                <div class="btn-group">                                                   
                                                    <button type="button" onclick="javascript:UnlockMediaPlan(@mediaPlan.MediaPlanId.ToString());" class="btn btn-sm btn-secondary js-tooltip-enabled" data-toggle="tooltip" title="Unlock" data-original-title="Unlock">
                                                        <i class="fa fa-unlock"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        }
                        else
                        {
                            <p>No Media Plans Locked.</p>
                        }
                    </div>
                </div>
            </div>
        </div>
        <!-- Schedules -->
        <div class="row">
            <div class="col-md-12">
                <div class="block block-rounded">
                    <div class="block-header block-header-default">
                        <h3 class="block-title">Schedules</h3>
                    </div>
                    <div class="block-content">
                        <!-- If you put a checkbox in thead section, it will automatically toggle all tbody section checkboxes -->
                        @if (Model.LockedSchedules != null && Model.LockedSchedules.Count > 0)
                        {
                            <table class="js-table-checkable table table-hover">
                                <thead>
                                    <tr>
                                        <th class="text-center">
                                        </th>
                                        <th>Name</th>
                                        <th class="d-none d-sm-table-cell" style="width: 20%;">Locked By</th>
                                        <th class="d-none d-sm-table-cell" style="width: 20%;">Locked Dt</th>
                                        <th class="d-none d-sm-table-cell" style="width: 20%;">Last Active Date</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var schedule in Model.LockedSchedules)
                                    {
                                        <tr>
                                            <td class="text-center">
                                                <img class="img-avatar img-avatar32" src="@schedule.LockedByUser.ImageUrl" alt="">
                                            </td>
                                            <td>
                                                <p class="font-w600 mb-10">@schedule.ScheduleName</p>
                                                <!--<p class="text-muted mb-0">locked by on locked date</p>-->
                                            </td>
                                            <td class="d-none d-sm-table-cell">
                                                @if (schedule.LockedByUser.LastActiveDt > DateTime.Now.AddMinutes(-30))
                                                {
                                                    <span class="badge badge-success">@schedule.LockedByUser.DisplayName</span>
                                                }
                                                else if (schedule.LockedByUser.LastActiveDt > DateTime.Now.AddHours(-8))
                                                {
                                                    <span class="badge badge-warning">@schedule.LockedByUser.DisplayName</span>
                                                }
                                                else
                                                {
                                                    <span class="badge badge-danger">@schedule.LockedByUser.DisplayName</span>
                                                }
                                            </td>
                                            <td class="d-none d-sm-table-cell">
                                                <p class="text-muted">@schedule.LockedDt.ToString()</p>
                                            </td>
                                            <td class="d-none d-sm-table-cell">
                                                <p class="text-muted">@schedule.LockedByUser.LastActiveDt.ToString()</p>
                                            </td>
                                            <td class="text-center">
                                                <div class="btn-group">
                                                    <!-- MOREWORK:  Implement loading via id for sticky gui

                                                <button type="button" onclick="javascript:window.location.href='/ManageMedia/Schedule?ScheduleId=@schedule.ScheduleId.ToString()'" class="btn btn-sm btn-secondary js-tooltip-enabled" data-toggle="tooltip" title="Load Page" data-original-title="Load Page">
                                                    <i class="fa fa-link"></i>
                                                </button>
                                                -->
                                                    <button type="button" onclick="javascript:UnlockSchedule(@schedule.ScheduleId.ToString());" class="btn btn-sm btn-secondary js-tooltip-enabled" data-toggle="tooltip" title="Unlock" data-original-title="Unlock">
                                                        <i class="fa fa-unlock"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        }
                        else
                        {
                            <p>No Schedules Locked.</p>
                        }
                    </div>
                </div>
            </div>
        </div>

        <!-- Proposals -->
        <div class="row">
            <div class="col-md-12">
                <div class="block block-rounded">
                    <div class="block-header block-header-default">
                        <h3 class="block-title">Proposals</h3>
                    </div>
                    <div class="block-content">
                        <!-- If you put a checkbox in thead section, it will automatically toggle all tbody section checkboxes -->
                        @if (Model.LockedProposals != null && Model.LockedProposals.Count > 0)
                        {
                            <table class="js-table-checkable table table-hover">
                                <thead>
                                    <tr>
                                        <th class="text-center">
                                        </th>
                                        <th>Name</th>
                                        <th class="d-none d-sm-table-cell" style="width: 20%;">Locked By</th>
                                        <th class="d-none d-sm-table-cell" style="width: 20%;">Locked Dt</th>
                                        <th class="d-none d-sm-table-cell" style="width: 20%;">Last Active Date</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var proposal in Model.LockedProposals)
                                    {
                                        <tr>
                                            <td class="text-center">
                                                <img class="img-avatar img-avatar32" src="@proposal.LockedByUser.ImageUrl" alt="">
                                            </td>
                                            <td>
                                                <p class="font-w600 mb-10">@proposal.ScheduleName</p>
                                                <!--<p class="text-muted mb-0">locked by on locked date</p>-->
                                            </td>
                                            <td class="d-none d-sm-table-cell">
                                                @{
                                                    string DisplayNamesLabel = "";
                                                    string DisplayNamesToolTips = "";
                                                    if (@proposal.LockedByUser.DisplayName.IndexOf(",") > 5)
                                                    {
                                                        DisplayNamesLabel = @proposal.LockedByUser.DisplayName.Split(",")[0] + " + " + Convert.ToString((proposal.LockedByUser.DisplayName.Split(",").Length - 1));                                                        
                                                    }
                                                    else
                                                    {
                                                        DisplayNamesLabel = @proposal.LockedByUser.DisplayName;
                                                    }
                                                    DisplayNamesToolTips = @proposal.LockedByUser.DisplayName;
                                                }
                                                @if (proposal.LockedByUser.LastActiveDt > DateTime.Now.AddMinutes(-30))
                                                {
                                                   @* <span class="badge badge-success">@proposal.LockedByUser.DisplayName</span>*@
                                                    <span class="badge badge-success" title="@DisplayNamesToolTips">@DisplayNamesLabel</span>
                                                }
                                                else if (proposal.LockedByUser.LastActiveDt > DateTime.Now.AddHours(-8))
                                                {
                                                    @*<span class="badge badge-warning">@proposal.LockedByUser.DisplayName</span>*@
                                                    <span class="badge badge-warning" title="@DisplayNamesToolTips">@DisplayNamesLabel</span>
                                                }
                                                else
                                                {
                                                    @*<span class="badge badge-danger">@proposal.LockedByUser.DisplayName</span>*@
                                                    <span class="badge badge-danger" title="@DisplayNamesToolTips">@DisplayNamesLabel</span>
                                                }
                                            </td>
                                            <td class="d-none d-sm-table-cell">
                                                <p class="text-muted">@proposal.LockedDt.ToString()</p>
                                            </td>
                                            <td class="d-none d-sm-table-cell">
                                                <p class="text-muted">@proposal.LockedByUser.LastActiveDt.ToString()</p>
                                            </td>
                                            <td class="text-center">
                                                <div class="btn-group">
                                                    <!-- MOREWORK:  Implement loading via id for sticky gui
                                                <button type="button" onclick="javascript:window.location.href='/ManageMedia/Proposal?ProposalId=@proposal.ScheduleId.ToString()'" class="btn btn-sm btn-secondary js-tooltip-enabled" data-toggle="tooltip" title="Load Page" data-original-title="Load Page">
                                                    <i class="fa fa-link"></i>
                                                </button>
                                                -->
                                                    <button type="button" onclick="javascript:UnlockProposals(@proposal.ScheduleId.ToString());" class="btn btn-sm btn-secondary js-tooltip-enabled" data-toggle="tooltip" title="Unlock" data-original-title="Unlock">
                                                        <i class="fa fa-unlock"></i>
                                                    </button>
                                                </div>
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        }
                        else
                        {
                            <p>No Proposals Locked.</p>
                        }
                    </div>
                </div>
            </div>
        </div>

        <!-- Post Logs -->
        <div class="row">
            <div class="col-md-12">
                <div class="block block-rounded">
                    <div class="block-header block-header-default">
                        <h3 class="block-title">Post Logs</h3>
                    </div>
                    <div class="block-content">
                        <!-- If you put a checkbox in thead section, it will automatically toggle all tbody section checkboxes -->
                        @if (Model.LockedPostLogs != null && Model.LockedPostLogs.Count > 0)
                        {
                            <table class="js-table-checkable table table-hover">
                                <thead>
                                    <tr>
                                        <th class="text-center">
                                        </th>
                                        <th>Name</th>
                                        <th class="d-none d-sm-table-cell" style="width: 20%;">Locked By</th>
                                        <th class="d-none d-sm-table-cell" style="width: 20%;">Locked Dt</th>
                                        <th class="d-none d-sm-table-cell" style="width: 20%;">Last Active Date</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var postlogs in Model.LockedPostLogs)
                                    {
                                        <tr>
                                            <td class="text-center">
                                                <img class="img-avatar img-avatar32" src="@postlogs.PostLogLockedUser.ImageUrl" alt="">
                                            </td>
                                            <td>
                                                @if (postlogs.Schedule != null)
                                                {
                                                    <p class="font-w600 mb-10">
                                                        @postlogs.Schedule.ScheduleName
                                                    </p>
                                                }
                                                else
                                                {
                                                    <p class="font-w600 mb-10">
                                                        @postlogs.ScheduleName
                                                    </p>
                                                }
                                                <p class="text-muted mb-0">Week: @postlogs.WeekDate.ToString("MM/dd/yyyy")</p>
                                            </td>
                                            <td class="d-none d-sm-table-cell">
                                                @if (postlogs.PostLogLockedUser.LastActiveDt > DateTime.Now.AddMinutes(-30))
                                                {
                                                    <span class="badge badge-success">@postlogs.PostLogLockedUser.DisplayName</span>
                                                }
                                                else if (postlogs.PostLogLockedUser.LastActiveDt > DateTime.Now.AddHours(-8))
                                                {
                                                    <span class="badge badge-warning">@postlogs.PostLogLockedUser.DisplayName</span>
                                                }
                                                else
                                                {
                                                    <span class="badge badge-danger">@postlogs.PostLogLockedUser.DisplayName</span>
                                                }
                                            </td>
                                            <td class="d-none d-sm-table-cell">
                                                <p class="text-muted">@postlogs.PostLogLockedDt.ToString()</p>
                                            </td>
                                            <td class="d-none d-sm-table-cell">
                                                <p class="text-muted">@postlogs.PostLogLockedUser.LastActiveDt.ToString()</p>
                                            </td>
                                            <td class="text-center">
                                                <div class="btn-group">
                                                    <!--
                                                <button type="button" onclick="javascript:window.location.href='/ManageMedia/Logs?PostLogId=@postlogs.PostLogId.ToString()'" class="btn btn-sm btn-secondary js-tooltip-enabled" data-toggle="tooltip" title="Load Page" data-original-title="Load Page">
                                                    <i class="fa fa-link"></i>
                                                </button>
                                                -->
                                                    @if (postlogs.Schedule == null)
                                                    {
                                                        <button type="button" onclick="javascript:UnlockPostLog(@postlogs.PostLogId.ToString(), '@postlogs.PostLogLockedUser.DisplayName', '@postlogs.PostLogLockedUser.LastActiveDt', '@postlogs.ScheduleName');" class="btn btn-sm btn-secondary js-tooltip-enabled" data-toggle="tooltip" title="Unlock" data-original-title="Unlock">
                                                            <i class="fa fa-unlock"></i>
                                                        </button>
                                                    }
                                                    else
                                                    {

                                                        <button type="button" onclick="javascript:UnlockPostLog(@postlogs.PostLogId.ToString(), '@postlogs.PostLogLockedUser.DisplayName', '@postlogs.PostLogLockedUser.LastActiveDt', '@postlogs.Schedule.ScheduleName');" class="btn btn-sm btn-secondary js-tooltip-enabled" data-toggle="tooltip" title="Unlock" data-original-title="Unlock">
                                                            <i class="fa fa-unlock"></i>
                                                        </button>
                                                    }
                                                </div>
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        }
                        else
                        {
                            <p>No Post Logs Locked.</p>
                        }
                    </div>
                </div>
            </div>
        </div>

        <!-- Pre Logs -->
        <div class="row">
            <div class="col-md-12">
                <div class="block block-rounded">
                    <div class="block-header block-header-default">
                        <h3 class="block-title">Pre Logs</h3>
                    </div>
                    <div class="block-content">
                        @if (Model.LockedPreLogs != null && Model.LockedPreLogs.Count > 0)
                        {
                            <table class="js-table-checkable table table-hover">
                                <thead>
                                    <tr>
                                        <th class="text-center">
                                        </th>
                                        <th>Name</th>
                                        <th class="d-none d-sm-table-cell" style="width: 20%;">Locked By</th>
                                        <th class="d-none d-sm-table-cell" style="width: 20%;">Locked Dt</th>
                                        <th class="d-none d-sm-table-cell" style="width: 20%;">Last Active Date</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var prelogs in Model.LockedPreLogs)
                                    {
                                        <tr>
                                            <td class="text-center">
                                                <img class="img-avatar img-avatar32" src="@prelogs.PreLogLockedUser.ImageUrl" alt="">
                                            </td>
                                            <td>
                                                <p class="font-w600 mb-10">
                                                    @prelogs.ScheduleName
                                                </p>                                                
                                                <p class="text-muted mb-0">Week: @prelogs.WeekDate.ToString("MM/dd/yyyy")</p>
                                            </td>
                                            <td class="d-none d-sm-table-cell">
                                                @if (prelogs.PreLogLockedUser.LastActiveDt > DateTime.Now.AddMinutes(-30))
                                                {
                                                    <span class="badge badge-success">@prelogs.PreLogLockedUser.DisplayName</span>
                                                }
                                                else if (prelogs.PreLogLockedUser.LastActiveDt > DateTime.Now.AddHours(-8))
                                                {
                                                    <span class="badge badge-warning">@prelogs.PreLogLockedUser.DisplayName</span>
                                                }
                                                else
                                                {
                                                    <span class="badge badge-danger">@prelogs.PreLogLockedUser.DisplayName</span>
                                                }
                                            </td>
                                            <td class="d-none d-sm-table-cell">
                                                <p class="text-muted">@prelogs.PreLogLockedDte.ToString()</p>
                                            </td>
                                            <td class="d-none d-sm-table-cell">
                                                <p class="text-muted">@prelogs.PreLogLockedUser.LastActiveDt.ToString()</p>
                                            </td>
                                            <td class="text-center">
                                                <div class="btn-group">
                                                    <button type="button" onclick="javascript:UnlockPreLog(@prelogs.PreLogId.ToString(), '@prelogs.PreLogLockedUser.DisplayName', '@prelogs.PreLogLockedUser.LastActiveDt', '@prelogs.ScheduleName');" class="btn btn-sm btn-secondary js-tooltip-enabled" data-toggle="tooltip" title="Unlock" data-original-title="Unlock">
                                                        <i class="fa fa-unlock"></i>
                                                    </button>                                                    
                                                </div>
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        }
                        else
                        {
                            <p>No Pre Logs Locked.</p>
                        }
                    </div>
                </div>
            </div>
        </div>

    </div>
    <!-- END Page Content -->
</main>
<!-- END Main Container -->